# Storage Sync Plugin

一个基于 Vite 和油猴脚本的跨页面存储数据同步工具，允许用户在不同网页间方便地共享和同步 localStorage 和 sessionStorage 数据。

## 📋 功能特性

- **可视化存储管理**：通过可拖拽的悬浮按钮和简洁的管理面板操作存储数据
- **跨页面数据同步**：在不同页面间快速共享 localStorage 和 sessionStorage 数据
- **灵活的数据选择**：可以选择性地保存和同步 sessionStorage 或 localStorage 数据
- **自动同步机制**：支持在打开新页面时自动同步存储数据
- **油猴菜单集成**：通过油猴脚本菜单快速访问核心功能
- **多种存储方案**：优先使用油猴 GM API，降级支持原生 localStorage
- **错误处理和兼容性**：内置完善的错误处理和跨浏览器兼容方案

## 🚀 技术栈

- **框架**：React 18 + TypeScript
- **UI 组件库**：Ant Design 4
- **构建工具**：Vite 7
- **油猴脚本支持**：vite-plugin-monkey 7
- **CSS 样式**：原生 CSS

## 📦 安装使用

### 开发环境设置

1. 克隆或下载项目到本地：

```bash
git clone https://github.com/qqq408370953/vite-monkey-plugin-storage.git
cd vite-monkey-plugin-storage
```

2. 安装依赖（推荐使用 pnpm）：

```bash
pnpm install
```

3. 启动开发服务器：

```bash
pnpm dev
```

4. 构建生产版本：

```bash
pnpm build
```

### 油猴脚本安装

1. 构建完成后，在 `dist` 目录下找到生成的油猴脚本文件
2. 将脚本内容复制到油猴插件的新建脚本编辑器中
3. 设置脚本的匹配规则（`@match`）以确定脚本在哪些网站上运行
4. 保存并启用脚本

## 💡 使用指南

### 基本操作

1. **显示存储信息**：
   - 点击页面上的悬浮数据库图标按钮
   - 在弹出的面板中点击「显示当前页面存储信息」按钮
   - 或通过油猴菜单选择「显示当前页面存储信息」

2. **保存并同步数据**：
   - 点击悬浮按钮打开管理面板
   - 输入目标网站地址
   - 选择要同步的存储类型（Session Storage 和/或 Local Storage）
   - 点击「获取当前页面数据并打开目标网站」按钮
   - 系统会自动打开目标网站并同步存储数据

3. **通过油猴菜单操作**：
   - 油猴菜单提供三个快速命令：
     - 显示当前页面存储信息
     - 保存当前页面存储数据
     - 将保存的数据写入当前页面

### 拖拽悬浮按钮

- 按住悬浮按钮可以拖动到页面上任何位置
- 按钮位置会自动限制在视口范围内，不会移出屏幕

## 🔧 配置说明

### 目标网站默认值

工具默认的目标网站地址为 `http://localhost:4000/`，您可以在每次使用时修改为所需的目标地址。

### 数据选择选项

- **包含 Session Storage**：勾选此项将同步会话存储数据
- **包含 Local Storage**：勾选此项将同步本地存储数据

## ⚙️ 核心功能实现

### 数据保存机制

工具优先使用油猴脚本的 GM API 进行数据存储，当 API 不可用时会降级到使用原生 localStorage。

### 自动同步机制

1. 在源页面保存数据时，同时创建同步标记
2. 在目标页面加载时，脚本会自动检测并应用同步标记中的数据
3. 应用完成后会自动刷新页面以确保数据生效

### 错误处理

- 存储访问权限检查
- 跨域数据访问降级方案
- 操作失败时的友好提示

## 🤝 贡献指南

欢迎提交 Issues 和 Pull Requests 来改进这个项目！

## 📝 许可证

本项目采用 MIT 许可证。

## 📧 联系信息

如有任何问题或建议，请通过 GitHub Issues 与我们联系。# Storage Sync Plugin

一个基于 Vite 和油猴脚本的跨页面存储数据同步工具，允许用户在不同网页间方便地共享和同步 localStorage 和 sessionStorage 数据。

## 📋 功能特性

- **可视化存储管理**：通过可拖拽的悬浮按钮和简洁的管理面板操作存储数据
- **跨页面数据同步**：在不同页面间快速共享 localStorage 和 sessionStorage 数据
- **灵活的数据选择**：可以选择性地保存和同步 sessionStorage 或 localStorage 数据
- **自动同步机制**：支持在打开新页面时自动同步存储数据
- **油猴菜单集成**：通过油猴脚本菜单快速访问核心功能
- **多种存储方案**：优先使用油猴 GM API，降级支持原生 localStorage
- **错误处理和兼容性**：内置完善的错误处理和跨浏览器兼容方案

## 🚀 技术栈

- **框架**：React 18 + TypeScript
- **UI 组件库**：Ant Design 4
- **构建工具**：Vite 7
- **油猴脚本支持**：vite-plugin-monkey 7
- **CSS 样式**：原生 CSS

## 📦 安装使用

### 开发环境设置

1. 克隆或下载项目到本地：

```bash
git clone https://github.com/qqq408370953/vite-monkey-plugin-storage.git
cd vite-monkey-plugin-storage
```

2. 安装依赖（推荐使用 pnpm）：

```bash
pnpm install
```

3. 启动开发服务器：

```bash
pnpm dev
```

4. 构建生产版本：

```bash
pnpm build
```

### 油猴脚本安装

1. 构建完成后，在 `dist` 目录下找到生成的油猴脚本文件
2. 将脚本内容复制到油猴插件的新建脚本编辑器中
3. 设置脚本的匹配规则（`@match`）以确定脚本在哪些网站上运行
4. 保存并启用脚本

## 💡 使用指南

### 基本操作

1. **显示存储信息**：
   - 点击页面上的悬浮数据库图标按钮
   - 在弹出的面板中点击「显示当前页面存储信息」按钮
   - 或通过油猴菜单选择「显示当前页面存储信息」

2. **保存并同步数据**：
   - 点击悬浮按钮打开管理面板
   - 输入目标网站地址
   - 选择要同步的存储类型（Session Storage 和/或 Local Storage）
   - 点击「获取当前页面数据并打开目标网站」按钮
   - 系统会自动打开目标网站并同步存储数据

3. **通过油猴菜单操作**：
   - 油猴菜单提供三个快速命令：
     - 显示当前页面存储信息
     - 保存当前页面存储数据
     - 将保存的数据写入当前页面

### 拖拽悬浮按钮

- 按住悬浮按钮可以拖动到页面上任何位置
- 按钮位置会自动限制在视口范围内，不会移出屏幕

## 🔧 配置说明

### 目标网站默认值

工具默认的目标网站地址为 `http://localhost:4000/`，您可以在每次使用时修改为所需的目标地址。

### 数据选择选项

- **包含 Session Storage**：勾选此项将同步会话存储数据
- **包含 Local Storage**：勾选此项将同步本地存储数据

## ⚙️ 核心功能实现

### 数据保存机制

工具优先使用油猴脚本的 GM API 进行数据存储，当 API 不可用时会降级到使用原生 localStorage。

### 自动同步机制

1. 在源页面保存数据时，同时创建同步标记
2. 在目标页面加载时，脚本会自动检测并应用同步标记中的数据
3. 应用完成后会自动刷新页面以确保数据生效

### 错误处理

- 存储访问权限检查
- 跨域数据访问降级方案
- 操作失败时的友好提示

## 🤝 贡献指南

欢迎提交 Issues 和 Pull Requests 来改进这个项目！

## 📝 许可证

本项目采用 MIT 许可证。

## 📧 联系信息

如有任何问题或建议，请通过 GitHub Issues 与我们联系。